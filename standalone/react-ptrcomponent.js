!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React")):"function"==typeof define&&define.amd?define(["React"],e):"object"==typeof exports?exports.ReactPtrComponent=e(require("React")):t.ReactPtrComponent=e(t.React)}(this,function(t){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),a=function(t,e,r){for(var o=!0;o;){var n=t,i=e,s=r;a=u=l=void 0,o=!1,null===n&&(n=Function.prototype);var a=Object.getOwnPropertyDescriptor(n,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(s)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;t=u,e=i,r=s,o=!0}},l=r(1),u=o(l),p=u["default"].Component,c=u["default"].PropTypes,d=function(t){function e(t){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={triggered:!1,triggering:!1}}return i(e,t),s(e,null,[{key:"propTypes",value:{autoReset:c.bool,scrollContainer:c.object,className:c.string,onTrigger:c.func},enumerable:!0},{key:"defaultProps",value:{autoReset:!0},enumerable:!0}]),s(e,[{key:"getParent",value:function(t){t=t||u["default"].findDOMNode(this);var e=t.parentNode;return this.props.scrollContainer&&(e=u["default"].findDOMNode(this.props.scrollContainer)),e}},{key:"getClassName",value:function(){var t=[];return this.props.className&&t.push(this.props.className),this.state.triggered&&t.push("triggered"),this.state.triggering&&t.push("triggering"),t.join(" ")||""}},{key:"componentDidMount",value:function(){var t=u["default"].findDOMNode(this);if(!t)return void console.warn("ScrollIntoViewportTrigger: did not found corresponding DOM Node.");var e=this.getParent(t);return e?(this.onHandleScroll=this.onHandleScroll.bind(this),void e.addEventListener("scroll",this.onHandleScroll,!1)):void console.warn("ScrollIntoViewportTrigger: did not found corresponding parentNode")}},{key:"componentWillUnmount",value:function(){var t=this.getParent();t&&t.removeEventListener("scroll",this.onHandleScroll)}},{key:"onHandleScroll",value:function(){var t=u["default"].findDOMNode(this),e=this.getParent(t);!this.state.triggering&&e.scrollTop+e.offsetHeight>=t.offsetTop&&(this.setState({triggered:!0,triggering:!0}),this.props.onTrigger&&this.props.onTrigger(this),this.props.autoReset&&this.setState({triggering:!1}))}},{key:"render",value:function(){return u["default"].createElement("div",{className:this.getClassName()},this.props.children)}}]),e}(p),h={IDLE:"idle",LOADING:"loading"},f=function(t){function e(t){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={ptrStatus:h.IDLE},this._ptrNode=null,this._ptrScrollOffset=0,this._ptrPulling=!1,this._ptrTriggered=!1,this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)}return i(e,t),s(e,null,[{key:"propTypes",value:{id:c.string,className:c.string,pullToRefreshIndicator:c.func,infiniteScrollingIndicator:c.func,onRefresh:c.func,onLoadFurther:c.func},enumerable:!0}]),s(e,[{key:"getClassName",value:function(){var t="ptr-container ptr-status-"+this.state.status;return this.props.className&&(t=t+" "+this.props.className),t}},{key:"setPtrStatus",value:function(t){this.setState({ptrStatus:t})}},{key:"componentDidMount",value:function(){this._ptrNode=u["default"].findDOMNode(this);var t=void 0,e=void 0;return this._ptrNode&&(t=this._ptrNode.querySelector(".ptr-container-indicator"))&&(e=this._ptrNode.querySelector(".ptr-container-content"))?(t.style.top="-"+t.offsetHeight+"px",this._ptrNode.addEventListener("touchstart",this.onTouchStart,!1),this._ptrNode.addEventListener("touchmove",this.onTouchMove,!1),void this._ptrNode.addEventListener("touchend",this.onTouchEnd,!1)):void console.warn("PtrContainer could not obtain its child nodes ...")}},{key:"componentWillUnmount",value:function(){this._ptrNode.removeEventListener("touchstart",this.onTouchStart),this._ptrNode.removeEventListener("touchmove",this.onTouchMove),this._ptrNode.removeEventListener("touchend",this.onTouchEnd)}},{key:"onTouchStart",value:function(){if(!this._ptrPulling&&this.state.ptrStatus==h.IDLE){var t=this._ptrNode||u["default"].findDOMNode(this);!t||t.scrollTop>0||(this._ptrPulling=!1,this._ptrTriggered=!1,this._ptrScrollOffset=t.scrollTop)}}},{key:"onTouchMove",value:function(){if(this.state.ptrStatus==h.IDLE){var t=this._ptrNode||u["default"].findDOMNode(this),e=void 0;t.scrollTop-this._ptrScrollOffset>0||(this._ptrPulling=!0,t&&(e=t.querySelector(".ptr-container-indicator"))&&(this._ptrTriggered=t.scrollTop<-1*e.offsetHeight))}}},{key:"onTouchEnd",value:function(){var t=this;this._ptrPulling&&this.state.ptrStatus==h.IDLE&&(this._ptrTriggered?(this.setState({ptrStatus:h.LOADING}),this.props.onRefresh&&setTimeout(function(){t.props.onRefresh(t)},50)):this.setState({ptrStatus:h.IDLE}),this._ptrPulling=!1,this._ptrTriggered=!1)}},{key:"render",value:function(){var t,e=[{id:this.props.id,style:{overflowY:"auto",WebkitOverflowScrolling:"touch"},className:this.getClassName()}],r=[];return r.push(u["default"].DOM.div({style:{position:this.state.ptrStatus==h.LOADING?"static":"absolute",top:"-40px",left:0,width:"100%",minHeight:"40px",WebkitTransform:"translateZ(0)",zIndex:1},className:"ptr-container-indicator"},this.props.pullToRefreshIndicator?this.props.pullToRefreshIndicator(this.state.ptrStatus):"Loading ...")),r.push(u["default"].DOM.div({style:{minHeight:"100%",paddingBottom:"1px",WebkitTransform:"translateZ(0)",zIndex:2},className:"ptr-container-content"},this.props.children)),this.props.infiniteScrollingIndicator&&this.props.onLoadFurther&&r.push(u["default"].createElement(d,{onTrigger:this.props.onLoadFurther,className:"ptr-container-further-loading"},this.props.infiniteScrollingIndicator())),e.push(r),(t=u["default"].DOM).div.apply(t,e)}}]),e}(p);e["default"]={PtrContainer:f,PtrStatus:h,ScrollIntoViewportTrigger:d},t.exports=e["default"]},function(e,r){e.exports=t}])});